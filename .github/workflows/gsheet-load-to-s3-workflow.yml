name: Descargar archivo de Google Drive y almacenarlo en AWS S3 Bucket

on:
  push:
    branches:
      - main

jobs:
  download:
    runs-on: ubuntu-20.04

    steps:
    - name: Checkout c√≥digo fuente
      uses: actions/checkout@v2

    - name: Descarga de archivo Excel mediante wget
      run: |
        wget -O 1employees-data-raw.xlsx https://docs.google.com/spreadsheets/d/13cCcKM6U_nXlFFxLmF0CUQkSSDOSZQFdJJLllK20Npw/edit?usp=sharing

    - name: Mostrar contenido descargado
      run: |
        ls

    - id: install-aws-cli
      uses: unfor19/install-aws-cli-action@v1
      with:
        version: 2
        verbose: false
        arch: amd64
        rootdir: ""
        workdir: ""

    - name: Configurar credenciales de AWS
      run: |
        aws configure set aws_access_key_id ${{ secrets.AWS_ACCESS_KEY_ID }}
        aws configure set aws_secret_access_key ${{ secrets.AWS_SECRET_ACCESS_KEY }}
        aws configure set aws_session_token ${{ secrets.AWS_SESSION_TOKEN }}
        aws configure set default.region us-east-1

    - name: Subir archivo a S3
      run: |
        aws s3 cp 2employees-data-raw.xlsx s3://bucket-prueba-tdg-kmrc-jnpp/
